{% extends "../layout.njk" %}

{% block questions %}

  <h1 class="govuk-heading-l">{{page.title}}</h1>
  <p>Please specify requirements for matching the person to a bed within an Approved Premises (AP).</p>

  {{ formPageRadios({
      fieldName: "apType",
      fieldset: {
        legend: {
          text: page.apTypeQuestion,
          classes: "govuk-fieldset__legend--m"
        }
      },
      items: convertKeyValuePairToRadioItems(page.apTypes, page.apType)
    },fetchContext()) }}

  {{
    formPageCheckboxes(
      {
        fieldName: "specialistSupportCriteria",
        fieldset: {
          legend: {
            text: "If this person would benefit from specialist support, select the relevant option below",
            classes: "govuk-fieldset__legend--m"
          }
        },
        hint: {
          html: "<p>There are only two AP with a semi-specialism in mental health nationally. Placement in one of these AP is not guaranteed.</p><p>Recovery Focused AP are currently being piloted nationally. Placement is not guaranteed.</p>"
        },
      items: page.specialistSupportCheckboxes
      },
      fetchContext()
    )
  }}

  {{
    formPageCheckboxes(
      {
        fieldName: "accessibilityCriteria",
        fieldset: {
          legend: {
            text: "Would the person benefit from any of the following?",
            classes: "govuk-fieldset__legend--m"
          }
        },
      items: page.accessibilityCheckBoxes
      },
      fetchContext()
    )
  }}

  <h2 class="govuk-heading-m">Placement requirements</h2>

  {{placementRequirementsTable(page.placementRequirementTableHeadings, page.placementRequirements, page.placementRequirementPreferences, page.body) | safe}}

  {{placementRequirementsTable(page.relevantInformationTableHeadings, page.offenceAndRiskInformationKeys, page.offenceAndRiskInformationRelevance, page.body) | safe}}

  {% set noDetails %}
  {{
    formPageInput(
      {
        fieldName: "lengthOfStayAgreedDetail",
        spellcheck: false,
        inputmode: "numeric",
        label: {
          text: "Provide recommended length of stay"
        },
        suffix: {
          text: "weeks"
        },
        classes: "govuk-input--width-2"
      },
      fetchContext()
    )
  }}
  {% endset -%}

  {{
    formPageRadios({
      fieldName: "lengthOfStayAgreed",
      fieldset: {
        legend: {
          text: "Do you agree with the suggested length of stay?",
          classes: "govuk-fieldset__legend--m"
        }
      },
      hint: {
        text: "Recommended length of stay: " + page.suggestedLengthOfStay
      },
      items: [
        {
          value: "yes",
          text: "Yes"
        },
        {
          value: "no",
          text: "No",
          conditional: {
            html: noDetails
          }
        }
      ]
    },
    fetchContext()
    )
  }}

  {{
    formPageTextarea(
      {
        fieldName: "cruInformation",
        type: "textarea",
        spellcheck: false,
        label: {
          text: "Information for Central Referral Unit (CRU) manager (optional)",
          classes: "govuk-label--m"
        },
        hint: {
          text: "Record any observations you think would benefit the CRU manager. They will use this information to match the person to a suitable AP."
        }
      },
      fetchContext()
    )
  }}

{% endblock %}
